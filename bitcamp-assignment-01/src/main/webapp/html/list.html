<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>개인 명함 관리</title>
<link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.min.css">
</head>
<body>
    <div class="container">
        <div class="row top">
            <h1 class="col-md-10">개인 명함 관리</h1>
            <a class="col-md-2" id="logout">로그아웃</a>
        </div>
        <div class="row middle">
            <div class="col-md-3 left-menu">
                <div class="member-search">
                    <input type="text" placeholder="검색">
                </div>
                <div class="member-list">
                    <ul id="member-list">
                    </ul>
                </div>
            </div>
            <div class="col-md-9 member-view">
                <div class="row"><div class="col-md-10"></div><button class="col-md-2" type="button">편집</button></div>
                <div class="member-form">
                    <div class="row">
                        <div class="col-md-3"></div><input class="col-md-9" type="text" name="name" placeholder="이름">
                    </div>
                    <div class="row">
                        <div class="col-md-3">휴대 전화 </div><input class="col-md-9" type="text" name="cell">
                    </div>
                    <div class="row">
                        <div class="col-md-3">일반 전화 </div><input class="col-md-9" type="text" name="tel">
                    </div>
                    <div class="row">
                        <div class="col-md-3">팩스</div><input class="col-md-9" type="text" name="fax">
                    </div>
                    <div class="row">
                        <div class="col-md-3">이메일</div><input class="col-md-9" type="email" name="email">
                    </div>
                    <div class="row">
                        <div class="col-md-3">메모</div><textarea class="col-md-9" name="memo" id="" cols="30" rows="10"></textarea>
                    </div>
                </div>
            </div>
        </div>
        <div class="row bottom">
            <a>회원탈퇴</a>
            <p>ⓒ2018비트캠프</p>
        </div>
    </div>
<script src="../node_modules/jquery/dist/jquery.min.js"></script>
<script src="../node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="../node_modules/popper.js/dist/umd/popper.min.js"></script>
<script src="../js/jquery.bit.js"></script>
<script src="../js/common.js"></script>
<script>
'use strict'
var serverApiAddr = 'http://localhost:8080/bitcamp-assignment-01';

function parseQuery(url) {
    var paramMap = {};
    var qs = url.split('?');
    if (qs.length > 1) {
        var params = qs[1].split('&');
        for(var param of params) {
            var kv = param.split('=');
            paramMap[kv[0]] = kv[1];
        }
    }
    return paramMap;
}

var {email} = parseQuery(location.href);

listLoad(email);

function listLoad(email){
    console.log(serverApiAddr);
    $.post(serverApiAddr + '/app/member/list',
            {email: email},
            function(data) {
			    console.log(serverApiAddr);
                if(data.status == 'success') {
                    console.log('listLoad() response OK!');
                    var target = $('#member-list');
                    for (var item of data.list) {
                        $("<li>")
                          .html(`<a href='#' data-id='${item.name}' 
                            class='viewLink'>${item.name}</a>`)
                          .appendTo(target);
                    }
                }else {
                    alert('아직 등록한 명함이 없습니다.');
                    //console.log(data.error);
                    //location.href = '#';
                }
            },
            'json');
};
</script>
</body>
</html>